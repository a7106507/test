<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link href="css/head.css" rel="stylesheet" type="text/css" />
		<link href="css/public.css" rel="stylesheet" type="text/css" />
		<link href="css/car.css" rel="stylesheet" type="text/css" />
	</head>
	<body>
		<div id="top">
			<div class="layout">
				<div class="header-l">
					<p>欢迎光临云同盟商城</p>
					<a href="Login&Register.html" target="_blank">登录</a>
					<span>|</span>
					<a href="Login&Register.html" target="_blank">注册</a>
				</div>
				<div class="header-r">
					<a onclick="landcar()">查看购物车</a>
					<a>选购中心</a>
					<a>标签云</a>
					<a>收藏本站</a>
					<span>关于我们：</span>
					<a class="code"></a>
					<div class="bigcode">
						<img src="images/weixin.jpg"/>
					</div>
				</div>
			</div>
		</div>
		<div id="head" class="layout">
			<a id="logo"><img src="images/logo.png"/></a>
			<form>
				<input type="text" id="txt" />
				<input type="button" id="btn" value="搜索产品" />
			</form>
			<div id="shppingcar" onclick="landcar()">
				<img src="images/cart.gif"/>
				<span>去购物车结算</span>
			</div>
		</div>
		<div id="nav">
			<div class="layout">
				<div class="menu4">
					<a href="index.html">首页</a>
					<a>品牌专区</a>
					<a>数控机床</a>
					<a>机器人</a>
					<a>云南机床</a>
					<a>上机磨床</a>
					<a>威达重工</a>
				</div>
			</div>
		</div>
		<div id="cont" class="layout">
			<dl id="mainbox">
				<dt>购物车</dt>
				<dd>
				</dd>
			</dl>
		</div>
		<div id="footer">
			<div class="layout">
				<ul class="link">
					<li>
						<dl>
							<dt><i></i>云南机床</dt>
							<dd>云南机床 CY-VTC</dd>
							<dd>云南机床 CY-</dd>
							<dd>云南机床 CY-CTC</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt><i></i>抚顺插床</dt>
							<dd>插床概念 插床分</dd>
							<dd>插床工操作插床时</dd>
							<dd>插床配件</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt><i></i>欧瑞液压</dt>
							<dd>四柱液压机油缸如</dd>
							<dd>小型液压机中的液</dd>
							<dd>四柱液压机液压卡</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt><i></i>威达重工</dt>
							<dd>立式加工中心辅助</dd>
							<dd>威达重工详解数控</dd>
							<dd>山东威达重工资质</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt><i></i>自贡钻床</dt>
							<dd>操作摇臂钻床注意</dd>
							<dd>摇臂钻床的概念</dd>
							<dd>摇臂钻床使用过程</dd>
						</dl>
					</li>
					<li>
						<dl>
							<dt><i></i>嘉湖数控</dt>
							<dd>嘉湖数控机床加工</dd>
							<dd>浙江嘉湖数控车床</dd>
							<dd>浙江嘉湖机床有限</dd>
						</dl>
					</li>
				</ul>
			</div>
			<div class="line">
				<i></i>
				<span></span>
			</div>
			<div class="layout">
				<ul class="tas">
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>
					<li>
						<div></div>
						<h3>中国领先</h3>
						<span>数控电商服务平台</span>
					</li>			
				</ul>
			</div>
			<div id="ftnav">
				<div class="layout">
					<a>云同盟商城介绍</a>
					<a>联系我们</a>
					<a>自贡钻床</a>
					<a>芜湖立车镗床</a>
					<a>上海冲剪</a>
					<a>营口机床</a>
				</div>
			</div>
			<div class="footer-t">
				<p>©2017-2027 云同盟商城 版权所有 ICP备案证书号:豫ICP备08100686号</p>
				<span>汇聚品牌，100%正品、实惠方便、首选！ Tel: 400-690-6610 联系QQ：1210177711 1210179955</span>
				<div class="footer-link">友情链接:<a>云同盟</a><span>|</span><a>云同盟规范新导航</a></div>
			</div>
		</div>
	</body>
	<script src="js/land.js"></script>
	<script>
		var url = "http://localhost/1903PHP/tongmengshangcheng/json/goods.json"
		function ajax(url,fn){
					var ajax=new XMLHttpRequest;
					ajax.open("GET",url,true);
					ajax.onreadystatechange=function(){
						if(ajax.readyState == 4&&ajax.status == 200){
							fn(ajax.responseText)
						}
					}
					ajax.send();
				}
		class display{
			constructor(){
				var that = this;
				this.goods = JSON.parse(localStorage.goods);
				this.obox = document.getElementById("mainbox");
				ajax(url,function(sre){
					that.data = JSON.parse(sre);
					that.init();
				})
			}
			init(){
				var src = ""
				src +=`<dt>购物车</dt>`;
				for(var i=0;i<this.goods.length;i++){
					for(var j=0;j<this.data.length;j++){
						if(this.goods[i].index == this.data[j].id){
							src +=`<dd id="${this.goods[i].index}">
										<input type="checkbox" class="checkbox"/>
										<img src="${this.data[j].url}" />
										<p>${this.data[j].name}</p>
										<div>数量：<input type="number" class="num" value="${this.goods[i].num}" min="1"/></div>
										<span class="delete">删除</span>
									</dd>`
						}
					}
				}
				this.obox.innerHTML = src;
				this.eve();
			}
			eve(){
				var that = this;
				this.obox.onclick=function(eve){
					var e = eve || window.event;
					var target = e.target||e.srcElement;
					console.log(target);
					if(target.className == "delete"){
						that.remove(target);
					}
					if(target.className == "num"){
						that.changenum(target);
					}
				}
			}
			remove(dd){
				dd.parentNode.remove();
				console.log(dd.parentNode.id);
				for(var i=0;i<this.goods.length;i++){
					if(this.goods[i].index == dd.parentNode.id){
						this.goods.splice(i,1);
						localStorage.goods = JSON.stringify(this.goods);
					}
				}
			}
			changenum(num){
				var that = this;
				num.oninput=function(){
					console.log(num.value);
					console.log(num.parentNode.parentNode.id);
					var id = num.parentNode.parentNode.id;
					for(var i=0;i<that.goods.length;i++){
					if(that.goods[i].index == id){
						that.goods.splice(i,1,{
							index:id,
							num:num.value
						});
						localStorage.goods = JSON.stringify(that.goods);
					}
				}
				}
			}
		}
		new display();
	</script>
</html>
